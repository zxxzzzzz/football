import{d as x,A as J}from"./index-5b2f7dc7.js";import{d as g,k as h,o as v,c as _,a as i,J as u,b as f,u as l,L as H,M as O,r as I,h as Q,j as U,w as T,N as S,e as y,f as q,Q as G,s as p,R as k}from"./index-3fba357a.js";import{T as R}from"./index-d03c3d57.js";import{B as w}from"./button-786cd362.js";import"./SearchOutlined-b8d84f69.js";import"./index-f551e820.js";import"./Input-10768f35.js";const K={class:"mb-2"},P={class:"mb-2"},X={class:"mb-2"},Z={class:"flex mb-2"},tt={class:"mr-2"},et={class:"flex mb-2 text-green-500"},st={class:"mr-2"},at=g({__name:"match",props:{dateTime:null,leagueName:null,tiCaiTeamList:null,num:null,extraTeamList:null},setup(d){const e=d;return h(()=>{if(!e.dateTime)return"";try{const m=["周日","周一","周二","周三","周四","周五","周六"],o=x(e.dateTime,"YYYY-MM-DD HH:mm").day();return m[o]}catch(m){return m.message}}),(m,o)=>{var n,s,c,L;return v(),_("div",null,[i("div",K,u(e==null?void 0:e.num),1),i("div",P,u(e==null?void 0:e.dateTime),1),i("div",X,u(e==null?void 0:e.leagueName),1),i("div",Z,[i("div",tt,u((n=e==null?void 0:e.tiCaiTeamList)==null?void 0:n[0]),1),i("div",null,u((s=e==null?void 0:e.tiCaiTeamList)==null?void 0:s[1]),1)]),i("div",et,[i("div",st,u((c=e==null?void 0:e.extraTeamList)==null?void 0:c[0]),1),i("div",null,u((L=e==null?void 0:e.extraTeamList)==null?void 0:L[1]),1)])])}}});var b=(d=>(d.noSale="100",d))(b||{});const it={class:"flex"},nt=g({__name:"tiCai",props:{itemList:null,revList:null,scoreRevList:null,halfRevList:null},setup(d){const e=d,m=h(()=>e.itemList.filter(s=>s.oddsTitle==="让球").map(s=>s.oddsItemList).flat().map(s=>({win:parseFloat(s[1]),lose:parseFloat(s[2]),scoreTitle:s[0]===b.noSale?"未开售":s[0]}))),o=h(()=>e.itemList.filter(s=>s.oddsTitle==="总分").map(s=>s.oddsItemList).flat().map(s=>({win:parseFloat(s[1]),lose:parseFloat(s[2]),scoreTitle:s[0]===b.noSale?"未开售":s[0]}))),n=[{title:"让球",dataIndex:"scoreTitle",minWidth:48},{title:"胜",dataIndex:"win"},{title:"负",dataIndex:"lose"}];return(s,c)=>(v(),_("div",null,[f(l(R),{dataSource:l(m),columns:n,pagination:!1},null,8,["dataSource"]),i("div",it,[(v(!0),_(H,null,O(l(o),L=>(v(),_("div",null,[i("div",null,"总分："+u(L.scoreTitle),1),i("div",null,"胜   ："+u(L.win),1),i("div",null,"负   ："+u(L.lose),1)]))),256))])]))}}),lt=g({__name:"ball",props:{itemList:null},setup(d){const e=d,m=h(()=>e.itemList.filter(n=>n.oddsTitle==="让球").map(n=>{const s=n.oddsItemList;return{scoreText:s[0][0],win:parseFloat(s[0][1]),lose:parseFloat(s[0][2])}})),o=[{title:"让球",dataIndex:"scoreText",minWidth:48},{title:"胜",dataIndex:"win"},{title:"负",dataIndex:"lose"}];return(n,s)=>(v(),_("div",null,[f(l(R),{dataSource:l(m),columns:o,pagination:!1},null,8,["dataSource"])]))}}),ot={class:"flex"},rt={class:"mr-1.5rem"},ut=g({__name:"extra",props:{teamList:null,itemList:null,revList:null,scoreRevList:null,halfRevList:null},setup(d){const e=d,m=h(()=>e.itemList.filter(o=>o.oddsTitle==="总分").map(o=>o.oddsItemList.map(n=>({title:n[0],win:n[1],lose:n[2]}))).flat());return(o,n)=>(v(),_("div",null,[f(lt,{itemList:e.itemList},null,8,["itemList"]),i("div",ot,[(v(!0),_(H,null,O(l(m),s=>(v(),_("div",rt,[i("div",null,"总分："+u(s.title),1),i("div",null,"胜   ："+u(s.win),1),i("div",null,"负   ："+u(s.lose),1)]))),256))])]))}}),ct=i("div",{class:"bg-white"}," ",-1),mt=i("div",{class:"bg-gray-100"}," ",-1),dt={class:"mx-4"},ft={class:"flex flex-col"},gt=g({__name:"index",setup(d){const e=q(),m=G(),o=I([]),n=h(()=>o.value.sort((a,r)=>x(a.dateTime,"MM-DD HH:ss").valueOf()-x(r.dateTime,"MM-DD HH:ss").valueOf()));let s;const c=I(1),L=h(()=>c.value===0?"用rev排序":c.value===1?"用得分排序":c.value===2?"用时间排序":""),V=I(!1),Y={pageSize:300};async function j(){var C,D,N,M,F,B;if(m.path!=="/basketball")return!1;const a=location.origin,t=await(await fetch(`${a}/basketballData/?p=${p.password}&token=${p.token}`)).json();if(t.code!==200){if(k.error((t==null?void 0:t.msg)||"更新出错",20),(t==null?void 0:t.code)===619)return k.info("已停止数据自动更新",10),!1;if((t==null?void 0:t.code)===500&&(C=t==null?void 0:t.data)!=null&&C.token&&(localStorage.setItem("token",(D=t==null?void 0:t.data)==null?void 0:D.token),p.token=(N=t==null?void 0:t.data)==null?void 0:N.token),(t==null?void 0:t.code)===601)return k.info("为了保证账号安全，已停止数据自动更新。刷新页面可开始继续自动更新",10),!1;if(t.code===401)return p.password="",localStorage.setItem("ps",""),p.token="",localStorage.setItem("token",""),console.log("goto login"),e.push({path:"/login"}),!1}return(M=t.data)!=null&&M.matchData&&(k.success(`数据更新 ${(F=t==null?void 0:t.data)!=null&&F.timestamp?"距离当前"+(x().valueOf()-x(t.data.timestamp).valueOf())/1e3+"秒":""}, 在线人数${((B=t==null?void 0:t.data)==null?void 0:B.liveCount)||0}`,5),o.value=t.data.matchData,localStorage.setItem("token",t.data.token),p.token=t.data.token),!0}async function $(a,r){try{if(!await a())return}catch{}s=setTimeout(async()=>{try{await $(a,r)}catch{}},r)}Q(async()=>{$(async()=>document.hidden?!0:await j(),5*1e3)}),U(()=>{s&&clearTimeout(s)});const A=()=>{if(c.value===0){c.value=1;return}if(c.value===1){c.value=2;return}if(c.value===2){c.value=0;return}return 0},W=()=>{e.push({path:"/setting"})},z=(a,r)=>["bg-white","bg-gray-100"][r%2],E=[{title:"赛事",customRender({record:a}){return S(at,{dateTime:a.dateTime,tiCaiTeamList:a.tiCaiTeamList,extraTeamList:a.extraTeamList,leagueName:a.league,num:a.num})}},{title:"体彩",customRender({record:a}){return S(nt,{teamList:a.tiCaiTeamList,itemList:a.tiCaiItemList,revList:a.revList,scoreRevList:a.scoreRevList,halfRevList:a.halfRevList})}},{title:"外部",customRender({record:a}){return S(ut,{teamList:a.extraTeamList,itemList:a.extraItemList.filter(r=>["让球","总分","独赢"].includes(r.oddsTitle)),revList:a.revList,halfRevList:a.halfRevList,scoreRevList:a.scoreRevList})}}];return(a,r)=>(v(),_("div",null,[ct,mt,i("div",dt,[f(l(R),{dataSource:l(n),columns:E,bordered:"",rowClassName:z,pagination:Y},null,8,["dataSource"])]),f(l(J),{offsetBottom:400,style:{position:"absolute",right:"0px"}},{default:T(()=>[i("div",ft,[f(l(w),{type:"primary",onClick:r[0]||(r[0]=()=>V.value=!0),class:"my-2"},{default:T(()=>[y(" 消息")]),_:1}),f(l(w),{type:"primary",onClick:A,class:"my-2"},{default:T(()=>[y(u(l(L)),1)]),_:1}),f(l(w),{class:"my-2",onClick:W},{default:T(()=>[y(" 设置")]),_:1}),f(l(w),{class:"my-2",onClick:r[1]||(r[1]=t=>l(e).push("/"))},{default:T(()=>[y(" 足球")]),_:1})])]),_:1})]))}});export{gt as default};
