import{d as T,r as d,h as V,j as A,c as s,b as r,w as l,u as n,o,a as i,L as m,M as f,e as M,f as O,s as p,R as v,K as h,J as g}from"./index-67d36e82.js";import{A as R,d as $}from"./index-f7eb7401.js";import{L as w,D as y}from"./index-04a362ab.js";import{B as E}from"./button-d63e6193.js";import"./SearchOutlined-5762de53.js";const F={class:"flex flex-wrap mb-2"},J={class:"mb-2"},K={class:"flex flex-wrap"},U={class:"flex flex-wrap"},q={class:"flex flex-wrap mb-2"},G={class:"flex flex-wrap mb-2"},H={class:"flex flex-col"},ee=T({__name:"index",setup(P){const b=O(),c=["#78a5de","#4fb2a1","#205a13","#186174","#88b00b","#cf4b22","#9e57cd","#238910","#c18fde","#673b84","#760bbb","#557766","#557733","#337755"],C=d([]),L=d([]),k=d([]),I=d([]),S=d([]);let x;async function j(){var t,a,D,z;const u=location.origin,e=await(await fetch(`${u}/data/?p=${p.password}&token=${p.token}`)).json();if(e.code!==200){if(v.error((e==null?void 0:e.msg)||"更新出错",20),(e==null?void 0:e.code)===619)return v.info("已停止数据自动更新",10),!1;if((e==null?void 0:e.code)===601)return v.info("为了保证账号安全，已停止数据自动更新。刷新页面可开始继续自动更新",10),!1;if(e.code===401)return p.password="",localStorage.setItem("ps",""),p.token="",localStorage.setItem("token",""),console.log("goto login"),b.push({path:"/login"}),!1}return(a=(t=e.data)==null?void 0:t.matchData)!=null&&a.length&&(v.success(`数据更新 ${(D=e==null?void 0:e.data)!=null&&D.timestamp?"距离当前"+($().valueOf()-$(e.data.timestamp).valueOf())/1e3+"秒":""}, 在线人数${((z=e==null?void 0:e.data)==null?void 0:z.liveCount)||0}`,5),C.value=e.data.matchData,L.value=e.data.message1List,k.value=e.data.message2List,I.value=e.data.message3List,S.value=e.data.message4List,localStorage.setItem("token",e.data.token),p.token=e.data.token),!0}async function B(u,_){try{if(!await u())return}catch{}x=setTimeout(async()=>{try{await B(u,_)}catch{}},_)}const N=()=>{b.push({path:"/setting"})};return V(async()=>{B(async()=>document.hidden?!0:await j(),5*1e3)}),A(()=>{x&&clearTimeout(x)}),(u,_)=>(o(),s("div",null,[r(n(w),{"item-layout":"horizontal","data-source":L.value},{renderItem:l(({item:e})=>[i("div",F,[(o(!0),s(m,null,f(e.split(" "),(t,a)=>(o(),s("div",{style:h({color:c[a],margin:"0 4px"}),class:"whitespace-nowrap"},g(t),5))),256))])]),_:1},8,["data-source"]),r(n(y)),r(n(w),{"item-layout":"horizontal","data-source":k.value},{renderItem:l(({item:e})=>[i("div",J,[i("div",K,[(o(!0),s(m,null,f(e[0].split(" "),(t,a)=>(o(),s("div",{style:h({color:c[a],margin:"0 4px"}),class:"whitespace-nowrap"},g(t),5))),256))]),i("div",U,[(o(!0),s(m,null,f(e[1].split(" "),(t,a)=>(o(),s("div",{style:h({color:c[a],margin:"0 4px"}),class:"whitespace-nowrap"},g(t),5))),256))])])]),_:1},8,["data-source"]),r(n(y)),r(n(w),{"item-layout":"horizontal","data-source":I.value},{renderItem:l(({item:e})=>[i("div",q,[(o(!0),s(m,null,f(e.split(" "),(t,a)=>(o(),s("div",{style:h({color:c[a],margin:"0 4px"}),class:"whitespace-nowrap"},g(t),5))),256))])]),_:1},8,["data-source"]),r(n(y)),r(n(w),{"item-layout":"horizontal","data-source":S.value},{renderItem:l(({item:e})=>[i("div",G,[(o(!0),s(m,null,f(e.split(" "),(t,a)=>(o(),s("div",{style:h({color:c[a],margin:"0 4px"}),class:"whitespace-nowrap"},g(t),5))),256))])]),_:1},8,["data-source"]),r(n(R),{offsetBottom:400,style:{position:"absolute",right:"0px"}},{default:l(()=>[i("div",H,[r(n(E),{class:"my-2",onClick:N},{default:l(()=>[M(" 设置")]),_:1})])]),_:1})]))}});export{ee as default};
