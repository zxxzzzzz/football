import{d as g,A as Q}from"./index-bd5dd122.js";import{d as R,k as T,o as f,c as v,a as i,J as m,b as _,u as r,L as B,M as H,r as b,h as U,j as W,w as h,N as S,e as x,f as q,Q as G,s as L,R as y}from"./index-102b8e43.js";import{T as O}from"./index-57577a36.js";import{B as k}from"./button-07730cab.js";import"./SearchOutlined-83eb1919.js";import"./index-332793e9.js";import"./Input-0f409360.js";const K={class:"mb-2"},P={class:"mb-2"},X={class:"mb-2"},Z={class:"flex mb-2"},tt={class:"mr-2"},et={class:"flex mb-2 text-green-500"},st={class:"mr-2"},at=R({__name:"match",props:{dateTime:null,leagueName:null,tiCaiTeamList:null,num:null,extraTeamList:null},setup(d){const e=d;return T(()=>{if(!e.dateTime)return"";try{const u=["周日","周一","周二","周三","周四","周五","周六"],l=g(e.dateTime,"YYYY-MM-DD HH:mm").day();return u[l]}catch(u){return u.message}}),(u,l)=>{var a,c,n,p;return f(),v("div",null,[i("div",K,m(e==null?void 0:e.num),1),i("div",P,m(e==null?void 0:e.dateTime),1),i("div",X,m(e==null?void 0:e.leagueName),1),i("div",Z,[i("div",tt,m((a=e==null?void 0:e.tiCaiTeamList)==null?void 0:a[0]),1),i("div",null,m((c=e==null?void 0:e.tiCaiTeamList)==null?void 0:c[1]),1)]),i("div",et,[i("div",st,m((n=e==null?void 0:e.extraTeamList)==null?void 0:n[0]),1),i("div",null,m((p=e==null?void 0:e.extraTeamList)==null?void 0:p[1]),1)])])}}});var V=(d=>(d.noSale="100",d))(V||{});const it=R({__name:"tiCai",props:{itemList:null,revList:null,scoreRevList:null,halfRevList:null},setup(d){const e=d,u=T(()=>e.itemList.filter(a=>a.oddsTitle==="让球").map(a=>a.oddsItemList).flat().map(a=>({ratio:parseFloat(a[1]),scoreTitle:a[0]===V.noSale?"未开售":a[0]}))),l=[{title:"让球",dataIndex:"scoreTitle",minWidth:48},{title:"赔率",dataIndex:"ratio"}];return(a,c)=>(f(),v("div",null,[_(r(O),{dataSource:r(u),columns:l,pagination:!1},null,8,["dataSource"])]))}}),nt={class:"flex"},ot={class:"w-4rem h-1.5rem"},rt={class:"w-5rem h-1.5rem"},lt=R({__name:"extra",props:{teamList:null,itemList:null,revList:null,scoreRevList:null,halfRevList:null},setup(d){const e=d,u=T(()=>e.itemList.map(l=>l.oddsItemList.map(a=>({title:l.oddsTitle,item:a}))).flat());return(l,a)=>(f(),v("div",null,[(f(!0),v(B,null,H(r(u),c=>(f(),v("div",null,[i("div",nt,[i("div",ot,m(c.title),1),(f(!0),v(B,null,H(c.item,n=>(f(),v("div",rt,m(n),1))),256))])]))),256))]))}}),ut=i("div",{class:"bg-white"}," ",-1),ct=i("div",{class:"bg-gray-100"}," ",-1),mt={class:"mx-4"},dt={class:"flex flex-col"},pt=R({__name:"index",setup(d){const e=q(),u=G(),l=b([]),a=T(()=>l.value.sort((s,o)=>g(s.dateTime,"MM-DD HH:ss").valueOf()-g(o.dateTime,"MM-DD HH:ss").valueOf()));let c;const n=b(1),p=T(()=>n.value===0?"用rev排序":n.value===1?"用得分排序":n.value===2?"用时间排序":""),Y=b(!1),j={pageSize:300};async function A(){var $,w,I,D,N,M;if(u.path!=="/basketball")return!1;const s=location.origin,t=await(await fetch(`${s}/basketballData/?p=${L.password}&token=${L.token}`)).json();if(t.code!==200){if(y.error((t==null?void 0:t.msg)||"更新出错",20),(t==null?void 0:t.code)===619)return y.info("已停止数据自动更新",10),!1;if((t==null?void 0:t.code)===500&&($=t==null?void 0:t.data)!=null&&$.token&&(localStorage.setItem("token",(w=t==null?void 0:t.data)==null?void 0:w.token),L.token=(I=t==null?void 0:t.data)==null?void 0:I.token),(t==null?void 0:t.code)===601)return y.info("为了保证账号安全，已停止数据自动更新。刷新页面可开始继续自动更新",10),!1;if(t.code===401)return L.password="",localStorage.setItem("ps",""),L.token="",localStorage.setItem("token",""),console.log("goto login"),e.push({path:"/login"}),!1}return(D=t.data)!=null&&D.matchData&&(y.success(`数据更新 ${(N=t==null?void 0:t.data)!=null&&N.timestamp?"距离当前"+(g().valueOf()-g(t.data.timestamp).valueOf())/1e3+"秒":""}, 在线人数${((M=t==null?void 0:t.data)==null?void 0:M.liveCount)||0}`,5),l.value=t.data.matchData,localStorage.setItem("token",t.data.token),L.token=t.data.token),!0}async function C(s,o){try{if(!await s())return}catch{}c=setTimeout(async()=>{try{await C(s,o)}catch{}},o)}U(async()=>{C(async()=>document.hidden?!0:await A(),5*1e3)}),W(()=>{c&&clearTimeout(c)});const F=()=>{if(n.value===0){n.value=1;return}if(n.value===1){n.value=2;return}if(n.value===2){n.value=0;return}return 0},z=()=>{e.push({path:"/setting"})},E=(s,o)=>["bg-white","bg-gray-100"][o%2],J=[{title:"赛事",customRender({record:s}){return S(at,{dateTime:s.dateTime,tiCaiTeamList:s.tiCaiTeamList,extraTeamList:s.extraTeamList,leagueName:s.league,num:s.num})}},{title:"体彩",customRender({record:s}){return S(it,{teamList:s.tiCaiTeamList,itemList:s.tiCaiItemList,revList:s.revList,scoreRevList:s.scoreRevList,halfRevList:s.halfRevList})}},{title:"外部",customRender({record:s}){return S(lt,{teamList:s.extraTeamList,itemList:s.extraItemList.filter(o=>["让球","总分","独赢"].includes(o.oddsTitle)),revList:s.revList,halfRevList:s.halfRevList,scoreRevList:s.scoreRevList})}}];return(s,o)=>(f(),v("div",null,[ut,ct,i("div",mt,[_(r(O),{dataSource:r(a),columns:J,bordered:"",rowClassName:E,pagination:j},null,8,["dataSource"])]),_(r(Q),{offsetBottom:400,style:{position:"absolute",right:"0px"}},{default:h(()=>[i("div",dt,[_(r(k),{type:"primary",onClick:o[0]||(o[0]=()=>Y.value=!0),class:"my-2"},{default:h(()=>[x(" 消息")]),_:1}),_(r(k),{type:"primary",onClick:F,class:"my-2"},{default:h(()=>[x(m(r(p)),1)]),_:1}),_(r(k),{class:"my-2",onClick:z},{default:h(()=>[x(" 设置")]),_:1}),_(r(k),{class:"my-2",onClick:o[1]||(o[1]=t=>r(e).push("/"))},{default:h(()=>[x(" 足球")]),_:1})])]),_:1})]))}});export{pt as default};
